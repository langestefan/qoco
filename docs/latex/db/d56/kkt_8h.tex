\hypertarget{kkt_8h}{}\doxysection{include/kkt.h File Reference}
\label{kkt_8h}\index{include/kkt.h@{include/kkt.h}}
{\ttfamily \#include \char`\"{}cone.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}linalg.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}qdldl.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}structs.\+h\char`\"{}}\newline
Include dependency graph for kkt.\+h\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=284pt]{db/ddf/kkt_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=305pt]{de/d9b/kkt_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{kkt_8h_a7139a39ce63dadf3225134e8eaa09ce9}{allocate\+\_\+kkt}} (\mbox{\hyperlink{structQCOSWorkspace}{QCOSWorkspace}} $\ast$work)
\begin{DoxyCompactList}\small\item\em Allocate memory for KKT matrix. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{kkt_8h_a489712294c041513c348e2983c492b6d}{construct\+\_\+kkt}} (\mbox{\hyperlink{structQCOSWorkspace}{QCOSWorkspace}} $\ast$work)
\begin{DoxyCompactList}\small\item\em Constructs upper triangular part of KKT matrix with -\/I for Nestrov-\/\+Todd scaling matrix (the (3,3) block) \end{DoxyCompactList}\item 
void \mbox{\hyperlink{kkt_8h_a944d74cccfbc1ee385c89c3b3232d4e0}{initialize\+\_\+ipm}} (\mbox{\hyperlink{structQCOSSolver}{QCOSSolver}} $\ast$solver)
\begin{DoxyCompactList}\small\item\em Gets initial values for primal and dual variables such that (s,z) \textbackslash{}in C. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{kkt_8h_ab613ee541bfc09d68949baff31334351}{set\+\_\+nt\+\_\+block\+\_\+zeros}} (\mbox{\hyperlink{structQCOSWorkspace}{QCOSWorkspace}} $\ast$work)
\begin{DoxyCompactList}\small\item\em Set the Nesterov-\/\+Todd block to be zeros. Used prior to \mbox{\hyperlink{kkt_8h_a1498e55f92c85bf1710e039f2a3c49f0}{compute\+\_\+kkt\+\_\+residual()}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{kkt_8h_aa3966d7a0363a33b4dc0f7146fd1b6bc}{update\+\_\+nt\+\_\+block}} (\mbox{\hyperlink{structQCOSWorkspace}{QCOSWorkspace}} $\ast$work)
\begin{DoxyCompactList}\small\item\em Updates Nesterov-\/\+Todd scaling block of KKT matrix. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{kkt_8h_a1498e55f92c85bf1710e039f2a3c49f0}{compute\+\_\+kkt\+\_\+residual}} (\mbox{\hyperlink{structQCOSWorkspace}{QCOSWorkspace}} $\ast$work)
\begin{DoxyCompactList}\small\item\em Computes residual of KKT conditions and stores in work-\/$>$kkt-\/$>$rhs. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{kkt_8h_a2aec873a47cf5ab8676af7a7579b69a0}{construct\+\_\+kkt\+\_\+aff\+\_\+rhs}} (\mbox{\hyperlink{structQCOSWorkspace}{QCOSWorkspace}} $\ast$work)
\begin{DoxyCompactList}\small\item\em Constructs rhs for the affine scaling KKT system. Before calling this function, work-\/$>$kkt-\/$>$kktres must contain the residual of the KKT conditions as computed by \mbox{\hyperlink{kkt_8h_a1498e55f92c85bf1710e039f2a3c49f0}{compute\+\_\+kkt\+\_\+residual()}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{kkt_8h_a464c0bda0499a352cd89baefa4a19998}{construct\+\_\+kkt\+\_\+comb\+\_\+rhs}} (\mbox{\hyperlink{structQCOSWorkspace}{QCOSWorkspace}} $\ast$work)
\begin{DoxyCompactList}\small\item\em Constructs rhs for the combined direction KKT system. Before calling this function, work-\/$>$kkt-\/$>$kktres must contain the negative residual of the KKT conditions as computed by \mbox{\hyperlink{kkt_8h_a1498e55f92c85bf1710e039f2a3c49f0}{compute\+\_\+kkt\+\_\+residual()}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{kkt_8h_abdca566d11410ac9d9cba933b1db6ea9}{predictor\+\_\+corrector}} (\mbox{\hyperlink{structQCOSSolver}{QCOSSolver}} $\ast$solver)
\begin{DoxyCompactList}\small\item\em Performs Mehrotra predictor-\/corrector step. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyAuthor}{Author}
Govind M. Chari \href{mailto:govindchari1@gmail.com}{\texttt{ govindchari1@gmail.\+com}}
\end{DoxyAuthor}
\hypertarget{utils_8c_LICENSE}{}\doxysubsection{LICENSE}\label{utils_8c_LICENSE}
Copyright (c) 2024, Govind M. Chari This source code is licensed under the BSD 2-\/Clause License\hypertarget{utils_8h_DESCRIPTION}{}\doxysubsection{DESCRIPTION}\label{utils_8h_DESCRIPTION}
Provides various functions for solving, constructing and updating KKT systems. 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{kkt_8h_a7139a39ce63dadf3225134e8eaa09ce9}\label{kkt_8h_a7139a39ce63dadf3225134e8eaa09ce9}} 
\index{kkt.h@{kkt.h}!allocate\_kkt@{allocate\_kkt}}
\index{allocate\_kkt@{allocate\_kkt}!kkt.h@{kkt.h}}
\doxysubsubsection{\texorpdfstring{allocate\_kkt()}{allocate\_kkt()}}
{\footnotesize\ttfamily void allocate\+\_\+kkt (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structQCOSWorkspace}{QCOSWorkspace}} $\ast$}]{work }\end{DoxyParamCaption})}



Allocate memory for KKT matrix. 


\begin{DoxyParams}{Parameters}
{\em work} & Pointer to workspace. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{kkt_8h_a1498e55f92c85bf1710e039f2a3c49f0}\label{kkt_8h_a1498e55f92c85bf1710e039f2a3c49f0}} 
\index{kkt.h@{kkt.h}!compute\_kkt\_residual@{compute\_kkt\_residual}}
\index{compute\_kkt\_residual@{compute\_kkt\_residual}!kkt.h@{kkt.h}}
\doxysubsubsection{\texorpdfstring{compute\_kkt\_residual()}{compute\_kkt\_residual()}}
{\footnotesize\ttfamily void compute\+\_\+kkt\+\_\+residual (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structQCOSWorkspace}{QCOSWorkspace}} $\ast$}]{work }\end{DoxyParamCaption})}



Computes residual of KKT conditions and stores in work-\/$>$kkt-\/$>$rhs. 

clang-\/format off \begin{DoxyVerb}  [ P   A^T   G^T ] [ x ]   [    c   ]
\end{DoxyVerb}
 res = $\vert$ A 0 0 $\vert$ $\vert$ y \mbox{]} + $\vert$ -\/b $\vert$ \mbox{[} G 0 0 \mbox{]} \mbox{[} z \mbox{]} \mbox{[} -\/h + s \mbox{]}

clang-\/format on


\begin{DoxyParams}{Parameters}
{\em work} & Pointer to workspace. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{kkt_8h_a489712294c041513c348e2983c492b6d}\label{kkt_8h_a489712294c041513c348e2983c492b6d}} 
\index{kkt.h@{kkt.h}!construct\_kkt@{construct\_kkt}}
\index{construct\_kkt@{construct\_kkt}!kkt.h@{kkt.h}}
\doxysubsubsection{\texorpdfstring{construct\_kkt()}{construct\_kkt()}}
{\footnotesize\ttfamily void construct\+\_\+kkt (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structQCOSWorkspace}{QCOSWorkspace}} $\ast$}]{work }\end{DoxyParamCaption})}



Constructs upper triangular part of KKT matrix with -\/I for Nestrov-\/\+Todd scaling matrix (the (3,3) block) 

clang-\/format off \begin{DoxyVerb}[ P   A^T   G^T ]
\end{DoxyVerb}
 K = $\vert$ A 0 0 $\vert$ \mbox{[} G 0 -\/I \mbox{]}

clang-\/format on


\begin{DoxyParams}{Parameters}
{\em work} & Pointer to \mbox{\hyperlink{structQCOSWorkspace}{QCOSWorkspace}} \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{kkt_8h_a2aec873a47cf5ab8676af7a7579b69a0}\label{kkt_8h_a2aec873a47cf5ab8676af7a7579b69a0}} 
\index{kkt.h@{kkt.h}!construct\_kkt\_aff\_rhs@{construct\_kkt\_aff\_rhs}}
\index{construct\_kkt\_aff\_rhs@{construct\_kkt\_aff\_rhs}!kkt.h@{kkt.h}}
\doxysubsubsection{\texorpdfstring{construct\_kkt\_aff\_rhs()}{construct\_kkt\_aff\_rhs()}}
{\footnotesize\ttfamily void construct\+\_\+kkt\+\_\+aff\+\_\+rhs (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structQCOSWorkspace}{QCOSWorkspace}} $\ast$}]{work }\end{DoxyParamCaption})}



Constructs rhs for the affine scaling KKT system. Before calling this function, work-\/$>$kkt-\/$>$kktres must contain the residual of the KKT conditions as computed by \mbox{\hyperlink{kkt_8h_a1498e55f92c85bf1710e039f2a3c49f0}{compute\+\_\+kkt\+\_\+residual()}}. 


\begin{DoxyParams}{Parameters}
{\em work} & Pointer to workspace. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{kkt_8h_a464c0bda0499a352cd89baefa4a19998}\label{kkt_8h_a464c0bda0499a352cd89baefa4a19998}} 
\index{kkt.h@{kkt.h}!construct\_kkt\_comb\_rhs@{construct\_kkt\_comb\_rhs}}
\index{construct\_kkt\_comb\_rhs@{construct\_kkt\_comb\_rhs}!kkt.h@{kkt.h}}
\doxysubsubsection{\texorpdfstring{construct\_kkt\_comb\_rhs()}{construct\_kkt\_comb\_rhs()}}
{\footnotesize\ttfamily void construct\+\_\+kkt\+\_\+comb\+\_\+rhs (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structQCOSWorkspace}{QCOSWorkspace}} $\ast$}]{work }\end{DoxyParamCaption})}



Constructs rhs for the combined direction KKT system. Before calling this function, work-\/$>$kkt-\/$>$kktres must contain the negative residual of the KKT conditions as computed by \mbox{\hyperlink{kkt_8h_a1498e55f92c85bf1710e039f2a3c49f0}{compute\+\_\+kkt\+\_\+residual()}}. 


\begin{DoxyParams}{Parameters}
{\em work} & Pointer to workspace. \\
\hline
\end{DoxyParams}
ds = -\/cone\+\_\+product(lambda, lambda) -\/ settings.\+mehrotra $\ast$ cone\+\_\+product((W\textquotesingle{} \textbackslash{} Dsaff), (W $\ast$ Dzaff), pdata) + sigma $\ast$ mu $\ast$ e.\mbox{\Hypertarget{kkt_8h_a944d74cccfbc1ee385c89c3b3232d4e0}\label{kkt_8h_a944d74cccfbc1ee385c89c3b3232d4e0}} 
\index{kkt.h@{kkt.h}!initialize\_ipm@{initialize\_ipm}}
\index{initialize\_ipm@{initialize\_ipm}!kkt.h@{kkt.h}}
\doxysubsubsection{\texorpdfstring{initialize\_ipm()}{initialize\_ipm()}}
{\footnotesize\ttfamily void initialize\+\_\+ipm (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structQCOSSolver}{QCOSSolver}} $\ast$}]{solver }\end{DoxyParamCaption})}



Gets initial values for primal and dual variables such that (s,z) \textbackslash{}in C. 


\begin{DoxyParams}{Parameters}
{\em solver} & Pointer to solver. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{kkt_8h_abdca566d11410ac9d9cba933b1db6ea9}\label{kkt_8h_abdca566d11410ac9d9cba933b1db6ea9}} 
\index{kkt.h@{kkt.h}!predictor\_corrector@{predictor\_corrector}}
\index{predictor\_corrector@{predictor\_corrector}!kkt.h@{kkt.h}}
\doxysubsubsection{\texorpdfstring{predictor\_corrector()}{predictor\_corrector()}}
{\footnotesize\ttfamily void predictor\+\_\+corrector (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structQCOSSolver}{QCOSSolver}} $\ast$}]{solver }\end{DoxyParamCaption})}



Performs Mehrotra predictor-\/corrector step. 


\begin{DoxyParams}{Parameters}
{\em solver} & Pointer to solver. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{kkt_8h_ab613ee541bfc09d68949baff31334351}\label{kkt_8h_ab613ee541bfc09d68949baff31334351}} 
\index{kkt.h@{kkt.h}!set\_nt\_block\_zeros@{set\_nt\_block\_zeros}}
\index{set\_nt\_block\_zeros@{set\_nt\_block\_zeros}!kkt.h@{kkt.h}}
\doxysubsubsection{\texorpdfstring{set\_nt\_block\_zeros()}{set\_nt\_block\_zeros()}}
{\footnotesize\ttfamily void set\+\_\+nt\+\_\+block\+\_\+zeros (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structQCOSWorkspace}{QCOSWorkspace}} $\ast$}]{work }\end{DoxyParamCaption})}



Set the Nesterov-\/\+Todd block to be zeros. Used prior to \mbox{\hyperlink{kkt_8h_a1498e55f92c85bf1710e039f2a3c49f0}{compute\+\_\+kkt\+\_\+residual()}}. 


\begin{DoxyParams}{Parameters}
{\em work} & Pointer to workspace. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{kkt_8h_aa3966d7a0363a33b4dc0f7146fd1b6bc}\label{kkt_8h_aa3966d7a0363a33b4dc0f7146fd1b6bc}} 
\index{kkt.h@{kkt.h}!update\_nt\_block@{update\_nt\_block}}
\index{update\_nt\_block@{update\_nt\_block}!kkt.h@{kkt.h}}
\doxysubsubsection{\texorpdfstring{update\_nt\_block()}{update\_nt\_block()}}
{\footnotesize\ttfamily void update\+\_\+nt\+\_\+block (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structQCOSWorkspace}{QCOSWorkspace}} $\ast$}]{work }\end{DoxyParamCaption})}



Updates Nesterov-\/\+Todd scaling block of KKT matrix. 

\begin{DoxyVerb}[ P   A^T   G^T  ]
\end{DoxyVerb}
 K = $\vert$ A 0 0 $\vert$ \mbox{[} G 0 -\/W\textquotesingle{}W \mbox{]}


\begin{DoxyParams}{Parameters}
{\em work} & Pointer to workspace. \\
\hline
\end{DoxyParams}
